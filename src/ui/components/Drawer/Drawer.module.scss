@use "@/ui/tokens" as tokens;

// Overlay - backdrop
.overlay {
    position: fixed;
    inset: 0;
    z-index: 100;
    background: rgb(0 0 0 / 70%);

    // Halftone overlay for punk aesthetic
    @include tokens.pattern-halftone-lg;

    // Fade in animation
    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    animation: fadeIn 200ms ease-out;
}

// Content - drawer panel (base styles)
.content {
    @include tokens.border-standard;
    @include tokens.shadow-xl;

    position: fixed;
    z-index: 101;

    display: flex;
    flex-direction: column;

    background:
        linear-gradient(
            to bottom,
            rgb(255 255 255 / 98%) 0%,
            rgb(245 245 245 / 96%) 100%
        ),
        var(--color-block);

    // Texture overlay
    isolation: isolate;

    &::after {
        content: "";
        position: absolute;
        inset: 0;
        @include tokens.pattern-halftone-sm;
        opacity: 0.15;
        mix-blend-mode: soft-light;
        pointer-events: none;
        z-index: -1;
        border-radius: inherit;
    }

    &:focus-visible {
        outline: none;
    }
}

// Position: bottom (default sheet from bottom)
.bottom {
    bottom: 0;
    left: 0;
    right: 0;
    max-height: 90vh;
    border-radius: 1.6rem 1.6rem 0 0;
    border-bottom: none;

    // Extend background beyond screen during animation
    padding-bottom: 10vh;
    margin-bottom: -10vh;

    animation: slideUp 300ms var(--spring-bezier);

    @keyframes slideUp {
        from {
            transform: translateY(100%);
        }
        to {
            transform: translateY(0);
        }
    }

    // Centered on desktop
    @media (min-width: 640px) {
        left: 50%;
        right: auto;
        max-width: 32rem;
        width: 100%;
        border-radius: 2rem 2rem 0 0;
        transform: translateX(-50%);

        animation: slideUpCentered 300ms var(--spring-bezier);

        @keyframes slideUpCentered {
            from {
                transform: translateX(-50%) translateY(100%);
            }
            to {
                transform: translateX(-50%) translateY(0);
            }
        }
    }
}

// Position: top (sheet from top)
.top {
    top: 0;
    left: 0;
    right: 0;
    max-height: 90vh;
    border-radius: 0 0 1.6rem 1.6rem;
    border-top: none;

    // Extend background beyond screen during animation
    padding-top: 10vh;
    margin-top: -10vh;

    animation: slideDown 300ms var(--spring-bezier);

    @keyframes slideDown {
        from {
            transform: translateY(-100%);
        }
        to {
            transform: translateY(0);
        }
    }

    // Centered on desktop
    @media (min-width: 640px) {
        left: 50%;
        right: auto;
        max-width: 32rem;
        width: 100%;
        border-radius: 0 0 2rem 2rem;
        transform: translateX(-50%);

        animation: slideDownCentered 300ms var(--spring-bezier);

        @keyframes slideDownCentered {
            from {
                transform: translateX(-50%) translateY(-100%);
            }
            to {
                transform: translateX(-50%) translateY(0);
            }
        }
    }

    .handle {
        margin: 0.5rem auto 0.75rem;
    }
}

// Position: left (side sheet from left)
.left {
    top: 0;
    bottom: 0;
    left: 0;
    max-width: 90vw;
    width: 100%;
    border-radius: 0 1.6rem 1.6rem 0;
    border-left: none;

    // Extend background beyond screen during animation
    padding-left: 10vw;
    margin-left: -10vw;

    animation: slideInLeft 300ms var(--spring-bezier);

    @keyframes slideInLeft {
        from {
            transform: translateX(-100%);
        }
        to {
            transform: translateX(0);
        }
    }

    @media (min-width: 640px) {
        max-width: 28rem;
        border-radius: 0 2rem 2rem 0;
    }
}

// Position: right (side sheet from right)
.right {
    top: 0;
    bottom: 0;
    right: 0;
    max-width: 90vw;
    width: 100%;
    border-radius: 1.6rem 0 0 1.6rem;
    border-right: none;

    // Extend background beyond screen during animation
    padding-right: 10vw;
    margin-right: -10vw;

    animation: slideInRight 300ms var(--spring-bezier);

    @keyframes slideInRight {
        from {
            transform: translateX(100%);
        }
        to {
            transform: translateX(0);
        }
    }

    @media (min-width: 640px) {
        max-width: 28rem;
        border-radius: 2rem 0 0 2rem;
    }
}

// Position: center (dialog/modal)
.center {
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    max-width: 90vw;
    max-height: 85vh;
    width: 100%;
    overflow-y: auto;

    @include tokens.radius-quirky-lg;

    animation: scaleIn 300ms var(--spring-bezier);

    @keyframes scaleIn {
        from {
            opacity: 0;
            scale: 0.9;
            transform: translate(-50%, -50%);
        }
        to {
            opacity: 1;
            scale: 1;
            transform: translate(-50%, -50%);
        }
    }

    @media (min-width: 640px) {
        max-width: 32rem;
    }
}

// Handle - drag indicator
.handle {
    width: 3rem;
    height: 0.35rem;
    margin: 0.75rem auto 0.5rem;
    background: var(--color-ink);
    border-radius: 2rem;
    opacity: 0.3;

    // Subtle animation on mount
    @keyframes handlePulse {
        0%,
        100% {
            opacity: 0.3;
            scale: 1;
        }
        50% {
            opacity: 0.5;
            scale: 1.1;
        }
    }

    animation: handlePulse 1.5s ease-in-out;
}

// Header - top section
.header {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    padding: var(--spacing-lg) var(--spacing-xl) var(--spacing-md);

    // Center text for top/bottom sheets
    .bottom &,
    .top & {
        text-align: center;
    }

    // Left-align for side sheets and center dialog
    .left &,
    .right &,
    .center & {
        text-align: left;
    }
}

// Footer - bottom section
.footer {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    padding: var(--spacing-md) var(--spacing-xl) var(--spacing-lg);
    margin-top: auto;

    // Optional border separator
    border-top: 3px solid var(--color-ink);
    border-top-left-radius: var(--radius-sm);
    border-top-right-radius: var(--radius-sm);

    // Adjust bottom padding based on last button type (all drawer positions)
    // If last child is a ghost button, use smaller padding
    &:has(> :last-child[data-variant="ghost"]),
    &:has(> :last-child > [data-variant="ghost"]) {
        padding-bottom: var(--spacing-sm);
    }

    // If only one button and it's ghost, use medium padding
    &:has(> :only-child[data-variant="ghost"]),
    &:has(> :only-child > [data-variant="ghost"]) {
        padding-bottom: var(--spacing-md);
    }
}

// Content wrapper adjustments to prevent overflow from extended backgrounds
.bottom > *:not(.handle),
.top > *:not(.handle),
.left > *:not(.handle),
.right > *:not(.handle) {
    // Ensure content doesn't extend into the padding area
    max-width: 100%;
}

// Title - main heading
.title {
    @include tokens.text-shadow-bold;

    font-family: var(--font-family);
    font-size: var(--font-size-2xl);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    line-height: 1.2;
    color: var(--color-text);
}

// Description - subtitle
.description {
    font-family: var(--font-family);
    font-size: var(--font-size-sm);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text);
    opacity: 0.7;
    line-height: 1.4;
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
    .overlay,
    .bottom,
    .top,
    .left,
    .right,
    .center {
        animation: none;
    }

    .handle {
        animation: none;
    }
}
